universe.catalog.offers=function(e){var t=this,r=e.OFFERS;t.current=null,t.list={},t.properties=e.PROPERTIES,intec.isArray(r)?intec.each(r,function(e,r){t.list[r.ID]=r}):intec.isObject(r)&&(t.list=r),intec.extend(t,intec.ext.events(t)),intec.each(e.EVENTS,function(e,r){t.on(e,r)})},universe.catalog.offers.prototype.getParameters=function(){var e=this,t={offer:e.getCurrentOffer(),properties:{displayed:[],disabled:[],enabled:[],selected:[]}};intec.each(e.list,function(r,n){var i=e.getOfferPropertiesTree(n.ID);intec.each(i,function(e,r){var n={key:e,value:r};intec.inArray(n,t.properties.displayed,!0)||t.properties.displayed.push(n)})});var r=[],n=[],i=e.getCurrentOffer(),f=null;return null!=i&&(f=e.getOfferPropertiesTree(i.ID)),intec.each(e.properties,function(e,t){r.push(t.CODE)}),intec.each(r,function(r,s){intec.each(e.list,function(r,u){var c=!0,o=e.getOfferPropertiesTree(u.ID);if(null!=i?intec.each(n,function(e,t){if(o[t]!=f[t])return c=!1,!1}):n.length>0&&(c=!1),1==c){var a={key:s,value:o[s]};intec.inArray(a,t.properties.enabled,!0)||t.properties.enabled.push(a)}}),n.push(s)}),intec.each(t.properties.displayed,function(e,r){intec.inArray(r,t.properties.enabled,!0)||t.properties.disabled.push(r)}),null!=f&&intec.each(f,function(e,r){t.properties.selected.push({key:e,value:r})}),t},universe.catalog.offers.prototype.getOfferByID=function(e){if("string"==typeof e&&(e=parseInt(e)),isNaN(e))return null;if("number"==typeof e){var t=this.list[e];if(void 0!==t)return t}return null},universe.catalog.offers.prototype.getOfferByPropertiesTree=function(e){var t=null;return intec.each(this.list,function(r,n){var i=!0;if(intec.each(e,function(e,t){var r=n.PROPERTIES[e];if(!intec.isEmpty(t)&&!intec.isEmpty(r))switch(r.PROPERTY_TYPE){case"L":r.VALUE_ENUM_ID!=t&&(i=!1);break;default:r.VALUE!=t&&(i=!1)}}),i)return t=n,!1}),t},universe.catalog.offers.prototype.getCurrentOffer=function(){return this.getOfferByID(this.current)},universe.catalog.offers.prototype.setCurrentOfferByID=function(e){var t=this;return null!=t.getOfferByID(e)&&(t.current=e,t.trigger("offerChange",t.getParameters()),!0)},universe.catalog.offers.prototype.getOfferPropertiesTree=function(e){var t={},r=this.getOfferByID(e);return null==r?t:(intec.each(this.properties,function(e,n){var i=r.PROPERTIES[n.CODE],f="";if(!intec.isEmpty(i))switch(i.PROPERTY_TYPE){case"L":f=i.VALUE_ENUM_ID;break;default:f=i.VALUE}t[n.CODE]=f}),t)},universe.catalog.offers.prototype.setCurrentOfferByPropertyValue=function(e,t){var r,n=this,i=n.getCurrentOffer(),f=null,s={};if(null==i||!intec.isString(e))return!1;if(intec.each(n.properties,function(t,r){if(r.CODE==e)return f=r,!1}),null==f)return!1;var u=n.getOfferPropertiesTree(i.ID);return s={},intec.each(u,function(r,n){s[r]=n,r==e&&(s[r]=t)}),null!=(r=n.getOfferByPropertiesTree(s))?(this.setCurrentOfferByID(r.ID),!0):(s={},intec.each(u,function(r,n){if(s[r]=n,r==e)return s[r]=t,!1}),null!=(r=n.getOfferByPropertiesTree(s))&&(this.setCurrentOfferByID(r.ID),!0))},universe.catalog.offers.prototype.initialize=function(){var e=this;intec.each(e.list,function(t,r){return e.setCurrentOfferByID(r.ID),!1})};